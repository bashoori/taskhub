<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CSV & Excel Cleaner | Bita Digital Hub</title>
  <meta name="description" content="Upload and clean your CSV or Excel files ‚Äî remove duplicates, empty rows, or trim spaces. Free, fast, and secure tool by Bita Digital Hub." />
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="icon" type="image/png" href="../assets/taskhub-logo.png" />
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3215014361489762" crossorigin="anonymous"></script>
</head>

<body>
  <!-- Navbar -->
  <header class="navbar">
    <div class="nav-left">
      <img src="../assets/taskhub-logo.svg" alt="Logo" width="36" height="36" />
      <a href="../index.html" class="brand">Bita Digital Hub</a>
    </div>
    <nav>
      <a href="../index.html">Home</a>
      <a href="../about.html">About</a>
      <a href="../privacy.html">Privacy</a>
    </nav>
  </header>

  <div class="page-wrapper">
    <!-- Left Ad -->
    <aside class="ad-left">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-3215014361489762"
           data-ad-slot="6666666666"
           data-ad-format="auto"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </aside>

    <main class="container">
      <section class="tool-header">
        <h1 id="title">CSV & Excel Cleaner üßπ</h1>
        <p id="desc">Upload and clean your spreadsheet ‚Äî remove duplicates, empty rows, and trim spaces instantly.</p>

        <!-- Language Buttons -->
        <div class="lang-btns">
          <button id="btnEnglish" class="active">English</button>
          <button id="btnFarsi">ŸÅÿßÿ±ÿ≥€å</button>
        </div>
      </section>

      <div class="tool-box" style="max-width:600px;">
        <label id="lblUpload" for="fileInput">Upload a CSV or Excel file:</label>
        <input type="file" id="fileInput" accept=".csv, .xlsx" />

        <label id="lblOptions" style="margin-top:1rem;">Cleaning options:</label>
        <div style="text-align:left; display:flex; flex-direction:column; gap:0.4rem;">
          <label><input type="checkbox" id="trimSpaces" checked /> <span id="txtTrim">Trim spaces</span></label>
          <label><input type="checkbox" id="dropEmpty" checked /> <span id="txtDrop">Remove empty rows</span></label>
          <label><input type="checkbox" id="removeDupes" checked /> <span id="txtDupes">Remove duplicates</span></label>
        </div>

        <button id="btnClean" style="margin-top:1.2rem;">Clean File</button>

        <div id="output" class="output-box" style="display:none;">
          <p id="resultMsg" style="margin-bottom:1rem;">‚úÖ File cleaned successfully!</p>
          <a id="downloadLink" href="#" download="cleaned.csv" style="color:#2563eb;">‚¨áÔ∏è Download cleaned file</a>
        </div>
      </div>

      <!-- Mid Ad -->
      <div class="ad-mid">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-3215014361489762"
             data-ad-slot="8888888888"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>
    </main>

    <!-- Right Ad -->
    <aside class="ad-right">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-3215014361489762"
           data-ad-slot="9999999999"
           data-ad-format="auto"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </aside>
  </div>

  <!-- Footer -->
  <footer>
    <p>¬© 2025 <strong>Bita Digital Hub</strong> ‚Äî Smart, Simple, Free Tools.</p>
  </footer>

  <!-- Sticky Ad -->
  <div class="ad-sticky">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-3215014361489762"
         data-ad-slot="5555555555"
         data-ad-format="horizontal"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

  <!-- Script -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script>
    const texts = {
      en: {
        title: "CSV & Excel Cleaner üßπ",
        desc: "Upload and clean your spreadsheet ‚Äî remove duplicates, empty rows, and trim spaces instantly.",
        upload: "Upload a CSV or Excel file:",
        options: "Cleaning options:",
        trim: "Trim spaces",
        drop: "Remove empty rows",
        dupes: "Remove duplicates",
        clean: "Clean File",
        success: "‚úÖ File cleaned successfully!",
      },
      fa: {
        title: "Ÿæÿß⁄©‚Äå⁄©ŸÜŸÜÿØŸá CSV Ÿà Excel üßπ",
        desc: "ŸÅÿß€åŸÑ ÿ¨ÿØŸàŸÑ ÿÆŸàÿØ ÿ±ÿß ÿ¢ŸæŸÑŸàÿØ ⁄©ŸÜ€åÿØ ‚Äî ÿ≥ÿ∑ÿ±Ÿáÿß€å ÿÆÿßŸÑ€å ÿ±ÿß ÿ≠ÿ∞ŸÅ ⁄©ŸÜ€åÿØÿå ŸÅÿßÿµŸÑŸá‚ÄåŸáÿß ÿ±ÿß ÿ®ÿ®Ÿèÿ±€åÿØ Ÿà ÿØÿßÿØŸá‚ÄåŸáÿß ÿ±ÿß ÿ™ŸÖ€åÿ≤ ⁄©ŸÜ€åÿØ.",
        upload: "ŸÅÿß€åŸÑ CSV €åÿß Excel ÿ±ÿß ÿ¢ŸæŸÑŸàÿØ ⁄©ŸÜ€åÿØ:",
        options: "⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å Ÿæÿß⁄©‚Äåÿ≥ÿßÿ≤€å:",
        trim: "ÿ≠ÿ∞ŸÅ ŸÅÿßÿµŸÑŸá‚ÄåŸáÿß",
        drop: "ÿ≠ÿ∞ŸÅ ÿ≥ÿ∑ÿ±Ÿáÿß€å ÿÆÿßŸÑ€å",
        dupes: "ÿ≠ÿ∞ŸÅ ÿØÿßÿØŸá‚ÄåŸáÿß€å ÿ™⁄©ÿ±ÿßÿ±€å",
        clean: "Ÿæÿß⁄©‚Äåÿ≥ÿßÿ≤€å ŸÅÿß€åŸÑ",
        success: "‚úÖ ŸÅÿß€åŸÑ ÿ®ÿß ŸÖŸàŸÅŸÇ€åÿ™ ÿ™ŸÖ€åÿ≤ ÿ¥ÿØ!",
      }
    };

    function setLang(lang) {
      const t = texts[lang];
      document.body.dir = lang === "fa" ? "rtl" : "ltr";
      document.getElementById("title").innerText = t.title;
      document.getElementById("desc").innerText = t.desc;
      document.getElementById("lblUpload").innerText = t.upload;
      document.getElementById("lblOptions").innerText = t.options;
      document.getElementById("txtTrim").innerText = t.trim;
      document.getElementById("txtDrop").innerText = t.drop;
      document.getElementById("txtDupes").innerText = t.dupes;
      document.getElementById("btnClean").innerText = t.clean;
      document.getElementById("resultMsg").innerText = t.success;

      document.querySelectorAll(".lang-btns button").forEach(b => b.classList.remove("active"));
      document.getElementById(lang === "fa" ? "btnFarsi" : "btnEnglish").classList.add("active");
    }

    document.getElementById("btnEnglish").addEventListener("click", () => setLang("en"));
    document.getElementById("btnFarsi").addEventListener("click", () => setLang("fa"));
    setLang("en");

    // Clean logic
    document.getElementById("btnClean").addEventListener("click", () => {
      const file = document.getElementById("fileInput").files[0];
      if (!file) return alert("Please select a file.");

      const reader = new FileReader();
      reader.onload = (e) => {
        let data = e.target.result;
        let workbook, rows = [];

        if (file.name.endsWith(".csv")) {
          const csv = data.split("\n").map(r => r.split(","));
          rows = csv;
        } else {
          workbook = XLSX.read(data, { type: "binary" });
          const sheet = workbook.Sheets[workbook.SheetNames[0]];
          rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        }

        const trim = document.getElementById("trimSpaces").checked;
        const drop = document.getElementById("dropEmpty").checked;
        const dupes = document.getElementById("removeDupes").checked;

        // Trim
        if (trim) {
          rows = rows.map(r => r.map(v => (typeof v === "string" ? v.trim() : v)));
        }

        // Remove empty rows
        if (drop) {
          rows = rows.filter(r => r.join("").trim() !== "");
        }

        // Remove duplicates
        if (dupes) {
          const unique = new Set(rows.map(r => JSON.stringify(r)));
          rows = Array.from(unique).map(r => JSON.parse(r));
        }

        const csvContent = rows.map(r => r.join(",")).join("\n");
        const blob = new Blob([csvContent], { type: "text/csv" });
        const url = URL.createObjectURL(blob);
        const downloadLink = document.getElementById("downloadLink");
        downloadLink.href = url;
        document.getElementById("output").style.display = "block";
      };

      if (file.name.endsWith(".csv")) reader.readAsText(file);
      else reader.readAsBinaryString(file);
    });
  </script>
</body>
</html>
